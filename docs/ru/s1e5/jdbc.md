# JDBC

[..](./README.md)

**JDBC (Java Database Connectivity)** — это API (программный интерфейс приложений) на языке Java, предназначенный для взаимодействия с различными базами данных. JDBC предоставляет унифицированный способ для работы с базами данных из приложений, написанных на Java, позволяя разработчикам выполнять SQL-запросы, извлекать данные из базы данных и обрабатывать результаты, не заботясь о внутренних особенностях конкретной базы данных.

### Основные компоненты JDBC

1. **DriverManager**: Этот класс управляет списком драйверов баз данных, которые доступны для клиента. Он отвечает за установление соединения с базой данных.

2. **Connection**: Интерфейс `Connection` представляет собой сеанс работы с конкретной базой данных. С помощью объектов `Connection` можно создавать объекты `Statement` для выполнения SQL-запросов и управлять транзакциями.

3. **Statement**: С помощью интерфейса `Statement` можно отправлять SQL-запросы в базу данных. Существуют различные типы объектов `Statement`, такие как `Statement`, `PreparedStatement`, и `CallableStatement`, которые используются для выполнения статических SQL-запросов, параметризованных запросов и хранимых процедур соответственно.

4. **ResultSet**: Объекты `ResultSet` содержат результаты выполнения SQL-запросов. С помощью `ResultSet` можно перебирать строки результатов и извлекать данные из колонок.

5. **SQLException**: Этот класс используется для обработки SQL-исключений, которые могут возникнуть в процессе взаимодействия с базой данных.

### Пример использования JDBC

Вот базовый пример кода на Java, демонстрирующий использование JDBC для выполнения запроса к базе данных:

```java
import java.sql.*;

public class TestJDBC {
    public static void main(String[] args) {
        try {
            // Загрузка JDBC драйвера
            Class.forName("com.mysql.jdbc.Driver");
            // Установка соединения с базой данных
            Connection connection = DriverManager.getConnection("jdbc:mysql://localhost:3306/databaseName", "username", "password");

            // Создание объекта Statement
            Statement statement = connection.createStatement();

            // Выполнение SQL-запроса
            ResultSet resultSet = statement.executeQuery("SELECT * FROM tableName");

            // Обработка результатов
            while (resultSet.next()) {
                System.out.println(resultSet.getString("columnName"));
            }

            // Закрытие соединений
            resultSet.close();
            statement.close();
            connection.close();
        } catch (ClassNotFoundException | SQLException e) {
            e.printStackTrace();
        }
    }
}
```

### Преимущества и недостатки JDBC

**Преимущества**:
- **Универсальность**: JDBC позволяет работать с любой базой данных, для которой существует соответствующий драйвер.
- **Простота**: API предоставляет простые и понятные механизмы для выполнения запросов и обработки результатов.
- **Интеграция с Java**: JDBC идеально интегрируется с языком Java, что делает его предпочтительным выбором для разработчиков Java-приложений.

**Недостатки**:
- **Производительность**: Для определенных операций и сценариев, особенно там, где требуется высокая производительность обработки больших объемов данных, JDBC может быть менее эффективен по сравнению с некоторыми другими технологиями, такими как пулы соединений или ORM-фреймворки.
- **Комплексность**: Работа с низкоуровневыми SQL-запросами и обработка исключений могут быть сложными для новичков.

В JDBC существует три основных типа интерфейсов для выполнения SQL-запросов: `Statement`, `PreparedStatement`, и `CallableStatement`. Каждый из них имеет свои особенности и предназначения:

### Statement, PreparedStatement и CallableStatement 
#### 1. Statement
`Statement` используется для выполнения простых SQL-запросов без параметров. Он предназначен для случаев, когда SQL-запрос выполняется без предварительной подготовки и не требует вставки динамических значений. `Statement` идеально подходит для выполнения SQL-команд, которые не изменяются и не содержат входных параметров, например, статические запросы или команды управления базой данных.

**Пример использования `Statement`**:
```java
Statement statement = connection.createStatement();
ResultSet rs = statement.executeQuery("SELECT * FROM users");
```

#### 2. PreparedStatement
`PreparedStatement` представляет собой предварительно скомпилированный SQL-запрос и является наиболее эффективным способом выполнения SQL-запросов. Он особенно полезен, когда нужно выполнить один и тот же запрос множество раз с различными параметрами. Это повышает производительность, так как позволяет СУБД заранее скомпилировать и оптимизировать план запроса. Кроме того, `PreparedStatement` помогает предотвратить SQL-инъекции, так как параметры запроса обрабатываются таким образом, что их невозможно интерпретировать как часть SQL кода.

**Пример использования `PreparedStatement`**:
```java
PreparedStatement pstmt = connection.prepareStatement("INSERT INTO users (name, email) VALUES (?, ?)");
pstmt.setString(1, "John Doe");
pstmt.setString(2, "john@example.com");
pstmt.executeUpdate();
```

#### 3. CallableStatement
`CallableStatement` используется для вызова хранимых процедур, которые могут содержать как входные, так и выходные параметры. Этот интерфейс расширяет возможности `PreparedStatement` путем добавления способности обрабатывать входные и выходные параметры, что делает его идеальным для сложных сценариев взаимодействия с базой данных, где требуется логика на стороне сервера.

**Пример использования `CallableStatement`**:
```java
CallableStatement cstmt = connection.prepareCall("{call sp_GetUserByEmail(?, ?)}");
cstmt.setString(1, "john@example.com");
cstmt.registerOutParameter(2, Types.VARCHAR);
cstmt.execute();
String userName = cstmt.getString(2);
```

### Выводы
- Используйте `Statement`, когда вам нужно выполнить простой SQL-запрос без параметров.
- Используйте `PreparedStatement` для выполнения SQL-запросов с параметрами, особенно когда один и тот же запрос необходимо выполнить многократно. Это повысит производительность и безопасность вашего приложения.
- Используйте `CallableStatement`, когда необходимо взаимодействовать с хранимыми процедурами в базе данных, особенно когда требуются операции с входными и выходными параметрами.
